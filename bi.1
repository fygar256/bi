.\" Manpage for bi
.TH BI 1 "April 2025" "Version 2.8.2" "User Commands"
.SH NAME
bi \- vi-like binary editor
.SH SYNOPSIS
.B bi
.RI [ options ]
.I targetfile
.SH DESCRIPTION
.B bi
is a binary editor designed to mimic the interface of the
UNIX editor
.BR vi (1).
Its name stands for "Binary editor like vI", and it is tailored for both vi and binary editing enthusiasts.

.SH EDIT MODE COMMANDS
.TP
.B <hex-key>
Set binary data.
.TP
.B hjkl, arrow keys
Move the cursor.
.TP
.B ^F, ^B
Scroll forward/backward by one page (256 bytes).
.TP
.B ^D, ^U
Scroll forward/backward by half a page (128 bytes).
.TP
.B ^L
Redraw the screen.
.TP
.B ^
Jump to the beginning of the line.
.TP
.B $
Jump to the end of the line.
.TP
.B m[a-z]
Mark current position.
.TP
.B '[a-z]
Jump to a marked position.
.TP
.B n, N
Search next/previous match.
.TP
.B M
Display current marks.
.TP
.B p, P
Paste yank buffer (overwrite/insert).
.TP
.B x
Delete a byte.
.TP
.B Z
Write and quit.
.TP
.B /
Enter search mode.
.TP
.B :
Enter command line mode.

.SH COMMAND LINE MODE
.TP
.B ;
Comment (ignored).
.TP
.B /<regexp>
Search string with regular expression.
.TP
.B //xx xx ...
Search for binary data.
.TP
.B !<string>
Invoke shell.
.TP
.B q, q!
Quit / Force quit.
.TP
.B wq, wq!
Write and quit.
.TP
.B w <filename>
Write to file.
.TP
.B t <file>, T <file>
Execute script in silent / verbose mode.
.TP
.B [offset]
Jump to address.
.TP
.B [offset]m[a-z]
Mark position at offset.
.TP
.B [offset]S<string>
Insert string at offset.
.TP
.B [offset]s<string>
Overwrite string from offset.
.TP
.B [offset]R<file>, r<file>
Read and insert / overwrite file from offset.
.TP
.B [offset] p, P
Paste yank buffer at offset (overwrite/insert).
.TP
.B [offset]i<length>,<xx>
Insert data of specified length.
.TP
.B y/str, y//xx xx ...
Yank string or binary data.
.TP
.B [start,end] d, y
Delete or yank range.
.TP
.B [start,end] f <xx>
Fill range with byte.
.TP
.B [start,end] &<data>, |<data>, ^<data>, ~
Bitwise AND, OR, XOR, NOT.
.TP
.B [start,end] v <dest>, c <dest>, i <dest>
Move / copy / insert data to destination.
.TP
.B [start,end] a /regexp/str
Replace regexp with string.
.TP
.B [start,end] a //data1//data2
Replace binary data1 with data2.
.TP
.B @ [start,end] <<, >> [[times],[0,1]]
Left/right shift or rotate (byte/multibyte) — not implemented.
.TP
.B <start>,<end>w<file>
Write range to file.
.TP
.B <CR> or <ESC>
Return to on-screen mode.

.SH EXPRESSIONS
.TP
Expressions may be used for addresses:
.B <expr> := <factor> [+|-] <factor>
.TP
A factor can be a hex value or a decimal prefixed with '#'.
Also supports:
.BR [a-z] (marks), 
.B 0 (top of file), 
.B . (current position), 
.B $ (end of file).

.SH SCRIPTING
bi supports script files (e.g.,
.B file.bi ).
To run a script:
.P
.B bi [-v] -s file.bi targetfile

.SH NOTES
.TP
Regular expressions can be used for string searches. Use '\\' to escape '/'.
.TP
Semicolons can be escaped using '\\;' if they are part of the command.
.TP
You can omit
.B [start], [end]
in most commands — current position is assumed.
.TP
.B %<length>
can be used to specify end as (start + length - 1).
.TP
The
.B m
(move) command handles
.B dest > filesize
by filling the gap with zeros.

.SH WARNINGS
.TP
.B NOTE:
Undo command is not supported.

.SH HISTORY
.TP
.B 1991-12-04
Started after losing a sector on a backup floppy.
.TP
.B 1992-01-23
Named 'bi', documentation v0.9999.
.TP
...
.TP
.B 2025-04-14
Version 2.8.2 — Added '%' notation and simple expression support.

.SH AUTHOR
T.Maekawa (fygar256)

.SH DISCLAIMER
The author assumes no responsibility for any consequence resulting from the use of this software.

